<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Boson Frame Grabber Part 1 | Greg Davill's Projects</title><meta name=keywords content="boson,boson-frame-grabber,thermal"><meta name=description content="Designing a thermal camera with the boson"><meta name=author content><link rel=canonical href=https://gregdavill.github.io/posts/boson-frame-grabber-pt1/><link crossorigin=anonymous href=/assets/css/stylesheet.min.0954dad75f8636465bfd8d73609f93ab0683e2be097b844f2d266a549583bb17.css integrity="sha256-CVTa11+GNkZb/Y1zYJ+TqwaD4r4Je4RPLSZqVJWDuxc=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://gregdavill.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://gregdavill.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://gregdavill.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://gregdavill.github.io/apple-touch-icon.png><link rel=mask-icon href=https://gregdavill.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Boson Frame Grabber Part 1"><meta property="og:description" content="Designing a thermal camera with the boson"><meta property="og:type" content="article"><meta property="og:url" content="https://gregdavill.github.io/posts/boson-frame-grabber-pt1/"><meta property="og:image" content="https://gregdavill.github.io/images/IMG_2586.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-06-03T00:00:00+00:00"><meta property="article:modified_time" content="2018-06-03T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://gregdavill.github.io/images/IMG_2586.jpg"><meta name=twitter:title content="Boson Frame Grabber Part 1"><meta name=twitter:description content="Designing a thermal camera with the boson"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://gregdavill.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Boson Frame Grabber Part 1","item":"https://gregdavill.github.io/posts/boson-frame-grabber-pt1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Boson Frame Grabber Part 1","name":"Boson Frame Grabber Part 1","description":"Designing a thermal camera with the boson","keywords":["boson","boson-frame-grabber","thermal"],"articleBody":"Background   FLIR has recently released a new OEM thermal Camera core. The Boson. These cores are self contained units that handle all the complexities of thermal imaging. They contain the thermal image sensor itself, a NUC/FFC shutter, and a lens assembly capable of focusing thermal energy. They also contain control electronics that present a standard CMOS style image sensor parallel interface. (DATA + CLK + HSYNC/VSYNC).\n  Having used the previous Thermal core from FLIR (The Tau 2) at work in project, our local distributor sent us some Boson cores to have around for integration. These unfortunately sat on our shelf for a few months. I wanted to learn how to design projects with FPGAs, so I decided to create an FPGA based product to capture the data stream from the Boson core into a usable format.\nDesign   Prototype v1 This is my very first FPGA project, I had used FPGAs before in a uni class on Digital Electronics. I had also learnt about the RISCV CPU architecture in Computer Architecture. But had never designed an FPGA into a project. I had just listened to an episode of the Amp Hour with Clifford Wolf, explaining the Lattice iCE40 open source toolchain: icestorm. So naturally I started there. (Also Naturally I picked the only variant in the iCE40 family that is not compatible with icestom. Still supported by lattices' tools.)\n  I crawled through the datasheets for the iCE40 Family and the variant I picked the iCE5LP4K, this was available in an easy to solder QFN 48. I decided to “simplify” the FPGA work by basically creating a large FIFO. This would capture a frame from the high speed datastream of the camera into some external RAM, then a microcontroller could read this data at its own pace and save it to an SD card. This probably would have worked, but I never developed the code for this completely. I had already started developing v2 with a larger FPGA on a smaller PCB. That will be talked about in part 2.\nThe RAM I chose was 64Mbit of hyperRAM. HyperRAM is self refreshing DRAM, which is refered to as Pseudo SRAM (PSRAM). This provides the high density benefits of DRAM with the simplicity of SRAM. It uses a 12 wire Interface bus which uses a 8bit DDR data bus and control signals. Due to its nature it’s a champ at long bursts of data. Perfect for the streamed data from the camera.\nI chose the SAMD51 as a microcontroller to handle the SD + FAT stuff mostly because I had just used them in another project. :) But they do feature a true SDMMC 4 bit interface which is essential to get any decent performance from an SD card.\nHardware Assembly   This is the part of a project I enjoy the most. I was able to hand assemble this prototype with a soldering iron and a hot air setup. (Tip: use lots of flux). The PCBs arrived from PCBWay, I had all my parts from Mouser/Digikey, I was ready to assemble.\nSome comically small parts on this board are these voltage regulators, They are adjustable dual LDOs, I used 0603 caps/resistors which individually are almost larger than the chip. Still an easy job to assemble with the right tools and some practice.\n  One interesting point of this prototype was the discovery I could make a custom footprint for the connector in KiCad, this custom version removes alot of pins that are unused in this application. This enables me to route out the signals all on the top layer. Because these pins may still have a voltage/signal present on them it is essential that a soldermask is present underneath the repurposed pins.\n    Firmware I designed the FPGA to be configured through a slave device of the samd51. This took too long to get working, by the time I had it working and had started working on the verilog the new prototype had arrived, and I decide to leave this project. It had served as a great first step in getting started with FPGAs and had given me added confidence with the tools and workflow.\nHowever I did develop a simple hyperRAM interface in a verilog simulator, when I tried it on the real hardware I discovered a serious bug…\n  Errata In my haste to develop an entire PCB with new components. I had mislabelled the coordinates on the BGA footprint. This required me to perform the following rework. Surprisingly this does actually work. My code that tested this was only running at 12MHz bus speed. But I’m still impressed with my own job. I did this without the aid of a microscope (I have since bought a microscope.)\n In Part 2 I take a look at the hardware behind version 2 prototype!\n","wordCount":"798","inLanguage":"en","image":"https://gregdavill.github.io/images/IMG_2586.jpg","datePublished":"2018-06-03T00:00:00Z","dateModified":"2018-06-03T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://gregdavill.github.io/posts/boson-frame-grabber-pt1/"},"publisher":{"@type":"Organization","name":"Greg Davill's Projects","logo":{"@type":"ImageObject","url":"https://gregdavill.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><header class=header><nav class=nav><div class=logo><a href=https://gregdavill.github.io/ accesskey=h title="Greg Davill's Projects (Alt + H)">Greg Davill's Projects</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://gregdavill.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://gregdavill.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://gregdavill.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://gregdavill.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://gregdavill.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://gregdavill.github.io/posts/>Posts</a></div><h1 class=post-title>Boson Frame Grabber Part 1</h1><div class=post-description>Designing a thermal camera with the boson</div><div class=post-meta><span title="2018-06-03 00:00:00 +0000 UTC">June 3, 2018</span>&nbsp;·&nbsp;4 min</div></header><div class=post-content><h2 id=background>Background<a hidden class=anchor aria-hidden=true href=#background>#</a></h2><figure><a href=/posts/boson-frame-grabber-pt1/images/IMG_2586.jpg><img srcset="/posts/boson-frame-grabber-pt1/images/IMG_2586_hu82b11a52075996e9dedea08bcd660681_126162_320x0_resize_q75_box.jpg 320w,
/posts/boson-frame-grabber-pt1/images/IMG_2586_hu82b11a52075996e9dedea08bcd660681_126162_600x0_resize_q75_box.jpg 600w,
/posts/boson-frame-grabber-pt1/images/IMG_2586_hu82b11a52075996e9dedea08bcd660681_126162_1200x0_resize_q75_box.jpg 2x" src=/posts/boson-frame-grabber-pt1/images/IMG_2586_hu82b11a52075996e9dedea08bcd660681_126162_600x0_resize_q75_box.jpg alt="FLIR Boson Thermal camera"></a></figure><p>FLIR has recently released a new OEM thermal Camera core. The Boson. These cores are self contained units that handle all the complexities of thermal imaging. They contain the thermal image sensor itself, a NUC/FFC shutter, and a lens assembly capable of focusing thermal energy. They also contain control electronics that present a standard CMOS style image sensor parallel interface. (DATA + CLK + HSYNC/VSYNC).</p><figure><a href=/posts/boson-frame-grabber-pt1/images/IMG_2593.jpg><img srcset="/posts/boson-frame-grabber-pt1/images/IMG_2593_huda6205873029797372337abaffabb949_105160_320x0_resize_q75_box.jpg 320w,
/posts/boson-frame-grabber-pt1/images/IMG_2593_huda6205873029797372337abaffabb949_105160_600x0_resize_q75_box.jpg 600w,
/posts/boson-frame-grabber-pt1/images/IMG_2593_huda6205873029797372337abaffabb949_105160_1200x0_resize_q75_box.jpg 2x" src=/posts/boson-frame-grabber-pt1/images/IMG_2593_huda6205873029797372337abaffabb949_105160_600x0_resize_q75_box.jpg alt></a></figure><p>Having used the previous Thermal core from FLIR (The Tau 2) at work in project, our local distributor sent us some Boson cores to have around for integration. These unfortunately sat on our shelf for a few months. I wanted to learn how to design projects with FPGAs, so I decided to create an FPGA based product to capture the data stream from the Boson core into a usable format.</p><h2 id=design>Design<a hidden class=anchor aria-hidden=true href=#design>#</a></h2><figure><a href=/posts/boson-frame-grabber-pt1/images/crushedICE-Front.png><img srcset="/posts/boson-frame-grabber-pt1/images/crushedICE-Front_huc7baf54af0267b218a92f47ebdc08ff9_854035_320x0_resize_box_2.png 320w,
/posts/boson-frame-grabber-pt1/images/crushedICE-Front_huc7baf54af0267b218a92f47ebdc08ff9_854035_600x0_resize_box_2.png 600w,
/posts/boson-frame-grabber-pt1/images/crushedICE-Front_huc7baf54af0267b218a92f47ebdc08ff9_854035_1200x0_resize_box_2.png 2x" src=/posts/boson-frame-grabber-pt1/images/crushedICE-Front_huc7baf54af0267b218a92f47ebdc08ff9_854035_600x0_resize_box_2.png alt></a></figure><h2 id=prototype-v1>Prototype v1<a hidden class=anchor aria-hidden=true href=#prototype-v1>#</a></h2><p>This is my very first FPGA project, I had used FPGAs before in a uni class on Digital Electronics. I had also learnt about the RISCV CPU architecture in Computer Architecture. But had never designed an FPGA into a project. I had just listened to an episode of the Amp Hour with Clifford Wolf, explaining the Lattice iCE40 open source toolchain: icestorm. So naturally I started there. (Also Naturally I picked the only variant in the iCE40 family that is not compatible with icestom. Still supported by lattices' tools.)</p><figure><a href=/posts/boson-frame-grabber-pt1/images/IMG_1648.jpg><img srcset="/posts/boson-frame-grabber-pt1/images/IMG_1648_hu2b91938a6afc7dd71c9407eee404ddce_407940_320x0_resize_q75_box.jpg 320w,
/posts/boson-frame-grabber-pt1/images/IMG_1648_hu2b91938a6afc7dd71c9407eee404ddce_407940_600x0_resize_q75_box.jpg 600w,
/posts/boson-frame-grabber-pt1/images/IMG_1648_hu2b91938a6afc7dd71c9407eee404ddce_407940_1200x0_resize_q75_box.jpg 2x" src=/posts/boson-frame-grabber-pt1/images/IMG_1648_hu2b91938a6afc7dd71c9407eee404ddce_407940_600x0_resize_q75_box.jpg alt></a></figure><p>I crawled through the datasheets for the iCE40 Family and the variant I picked the iCE5LP4K, this was available in an easy to solder QFN 48. I decided to &ldquo;simplify&rdquo; the FPGA work by basically creating a large FIFO. This would capture a frame from the high speed datastream of the camera into some external RAM, then a microcontroller could read this data at its own pace and save it to an SD card. This probably would have worked, but I never developed the code for this completely. I had already started developing v2 with a larger FPGA on a smaller PCB. That will be talked about in part 2.</p><p>The RAM I chose was 64Mbit of hyperRAM. HyperRAM is self refreshing DRAM, which is refered to as Pseudo SRAM (PSRAM). This provides the high density benefits of DRAM with the simplicity of SRAM. It uses a 12 wire Interface bus which uses a 8bit DDR data bus and control signals. Due to its nature it&rsquo;s a champ at long bursts of data. Perfect for the streamed data from the camera.</p><p>I chose the SAMD51 as a microcontroller to handle the SD + FAT stuff mostly because I had just used them in another project. :) But they do feature a true SDMMC 4 bit interface which is essential to get any decent performance from an SD card.</p><h2 id=hardware-assembly>Hardware Assembly<a hidden class=anchor aria-hidden=true href=#hardware-assembly>#</a></h2><figure><a href=/posts/boson-frame-grabber-pt1/images/IMG_1930.jpg><img srcset="/posts/boson-frame-grabber-pt1/images/IMG_1930_hu8b4f4b4440226eacb9b44ccb27c77ae3_318216_320x0_resize_q75_box.jpg 320w,
/posts/boson-frame-grabber-pt1/images/IMG_1930_hu8b4f4b4440226eacb9b44ccb27c77ae3_318216_600x0_resize_q75_box.jpg 600w,
/posts/boson-frame-grabber-pt1/images/IMG_1930_hu8b4f4b4440226eacb9b44ccb27c77ae3_318216_1200x0_resize_q75_box.jpg 2x" src=/posts/boson-frame-grabber-pt1/images/IMG_1930_hu8b4f4b4440226eacb9b44ccb27c77ae3_318216_600x0_resize_q75_box.jpg alt></a></figure><p>This is the part of a project I enjoy the most. I was able to hand assemble this prototype with a soldering iron and a hot air setup. (Tip: use lots of flux). The PCBs arrived from PCBWay, I had all my parts from Mouser/Digikey, I was ready to assemble.</p><p>Some comically small parts on this board are these voltage regulators, They are adjustable dual LDOs, I used 0603 caps/resistors which individually are almost larger than the chip. Still an easy job to assemble with the right tools and some practice.</p><figure><a href=/posts/boson-frame-grabber-pt1/images/IMG_1955.jpg><img srcset="/posts/boson-frame-grabber-pt1/images/IMG_1955_hub2b92a39c954dcf1bc7b13f9aca73e7d_324983_320x0_resize_q75_box.jpg 320w,
/posts/boson-frame-grabber-pt1/images/IMG_1955_hub2b92a39c954dcf1bc7b13f9aca73e7d_324983_600x0_resize_q75_box.jpg 600w,
/posts/boson-frame-grabber-pt1/images/IMG_1955_hub2b92a39c954dcf1bc7b13f9aca73e7d_324983_1200x0_resize_q75_box.jpg 2x" src=/posts/boson-frame-grabber-pt1/images/IMG_1955_hub2b92a39c954dcf1bc7b13f9aca73e7d_324983_600x0_resize_q75_box.jpg alt></a></figure><p>One interesting point of this prototype was the discovery I could make a custom footprint for the connector in KiCad, this custom version removes alot of pins that are unused in this application. This enables me to route out the signals all on the top layer. Because these pins may still have a voltage/signal present on them it is essential that a soldermask is present underneath the repurposed pins.</p><figure><a href=/posts/boson-frame-grabber-pt1/images/IMG_1962.jpg><img srcset="/posts/boson-frame-grabber-pt1/images/IMG_1962_hu6d1c6302145a9f0b162c3ad754a6e5e1_248976_320x0_resize_q75_box.jpg 320w,
/posts/boson-frame-grabber-pt1/images/IMG_1962_hu6d1c6302145a9f0b162c3ad754a6e5e1_248976_600x0_resize_q75_box.jpg 600w,
/posts/boson-frame-grabber-pt1/images/IMG_1962_hu6d1c6302145a9f0b162c3ad754a6e5e1_248976_1200x0_resize_q75_box.jpg 2x" src=/posts/boson-frame-grabber-pt1/images/IMG_1962_hu6d1c6302145a9f0b162c3ad754a6e5e1_248976_600x0_resize_q75_box.jpg alt></a></figure><figure><a href=/posts/boson-frame-grabber-pt1/images/IMG_1950.jpg><img srcset="/posts/boson-frame-grabber-pt1/images/IMG_1950_hu1c15e8e1f1fcdf882aa7b44f32cf47fe_326852_320x0_resize_q75_box.jpg 320w,
/posts/boson-frame-grabber-pt1/images/IMG_1950_hu1c15e8e1f1fcdf882aa7b44f32cf47fe_326852_600x0_resize_q75_box.jpg 600w,
/posts/boson-frame-grabber-pt1/images/IMG_1950_hu1c15e8e1f1fcdf882aa7b44f32cf47fe_326852_1200x0_resize_q75_box.jpg 2x" src=/posts/boson-frame-grabber-pt1/images/IMG_1950_hu1c15e8e1f1fcdf882aa7b44f32cf47fe_326852_600x0_resize_q75_box.jpg alt></a></figure><h2 id=firmware>Firmware<a hidden class=anchor aria-hidden=true href=#firmware>#</a></h2><p>I designed the FPGA to be configured through a slave device of the samd51. This took too long to get working, by the time I had it working and had started working on the verilog the new prototype had arrived, and I decide to leave this project. It had served as a great first step in getting started with FPGAs and had given me added confidence with the tools and workflow.</p><p>However I did develop a simple hyperRAM interface in a verilog simulator, when I tried it on the real hardware I discovered a serious bug&mldr;</p><figure><a href=/posts/boson-frame-grabber-pt1/images/IMG_2138.jpg><img srcset="/posts/boson-frame-grabber-pt1/images/IMG_2138_hu821c56c910c9d96ee991388f691a13b2_385763_320x0_resize_q75_box.jpg 320w,
/posts/boson-frame-grabber-pt1/images/IMG_2138_hu821c56c910c9d96ee991388f691a13b2_385763_600x0_resize_q75_box.jpg 600w,
/posts/boson-frame-grabber-pt1/images/IMG_2138_hu821c56c910c9d96ee991388f691a13b2_385763_1200x0_resize_q75_box.jpg 2x" src=/posts/boson-frame-grabber-pt1/images/IMG_2138_hu821c56c910c9d96ee991388f691a13b2_385763_600x0_resize_q75_box.jpg alt></a></figure><h2 id=errata>Errata<a hidden class=anchor aria-hidden=true href=#errata>#</a></h2><p>In my haste to develop an entire PCB with new components. I had mislabelled the coordinates on the BGA footprint. This required me to perform the following rework. Surprisingly this does actually work. My code that tested this was only running at 12MHz bus speed. But I&rsquo;m still impressed with my own job. I did this without the aid of a microscope (I have since bought a microscope.)</p><hr><p>In Part 2 I take a look at the hardware behind version 2 prototype!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://gregdavill.github.io/tags/boson/>boson</a></li><li><a href=https://gregdavill.github.io/tags/boson-frame-grabber/>boson-frame-grabber</a></li><li><a href=https://gregdavill.github.io/tags/thermal/>thermal</a></li></ul><nav class=paginav><a class=prev href=https://gregdavill.github.io/posts/boson-frame-grabber-pt2/><span class=title>« Prev Page</span><br><span>Boson Frame Grabber Part 2</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://gregdavill.github.io/>Greg Davill's Projects</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>